<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾·è¯­å˜æ ¼æ„å»ºå™¨ (German Declension Constructor)</title>
    <link rel="stylesheet" href="css/style.css?v=20241130_12">
    <!-- Import Map for Three.js -->
    <script type="importmap">
        {
            "imports": {
                "three": "../libs/three/build/three.module.js"
            }
        }
    </script>
</head>

<body>
    <!-- Loading Overlay (Minecraft Style) -->
    <div id="loading-overlay">
        <div class="mc-header">
            <h1 class="mc-logo">GERMAN GRAMMAR</h1>
            <div class="mc-subtitle">CONSTRUCTOR EDITION</div>
        </div>

        <div class="loading-container">
            <div class="loading-text">Initializing server...</div>
            <div class="loading-subtext">Generating terrain</div>
            <div class="loading-bar-bg">
                <div id="loading-bar"></div>
            </div>
        </div>

        <div class="mc-tip-box">
            <p id="mc-tip-text">Obsidian can only be mined with a diamond pickaxe.</p>
        </div>
    </div>

    <!-- Reward Layer (Background) -->
    <div id="reward-layer">
        <!-- Default to img1.jpg if available, otherwise handled by JS -->
        <img id="reward-img" src="assets/rewards/img1.jpg" alt="Reward Background" onerror="this.style.opacity=0">
        <div id="reward-overlay"></div>
    </div>

    <!-- 3D Canvas -->
    <div id="canvas-container"></div>

    <!-- UI Container -->
    <div id="ui-container">

        <header>
            <a href="../index.html" class="back-home-btn" id="btn-home">
                <span>ğŸ </span> <span class="text">Back to Home</span>
            </a>

            <div class="title-group">
                <h1 id="main-title">å¾·è¯­å˜æ ¼æ„å»ºå™¨</h1>
                <p class="subtitle" id="sub-title">å† è¯ä¸å½¢å®¹è¯è¯å°¾è®­ç»ƒ</p>
            </div>

            <div class="lang-switcher">
                <button id="btn-toggle-settings" class="lang-btn" title="Settings">âš™ï¸</button>
                <button class="lang-btn active" data-lang="zh">ä¸­</button>
                <button class="lang-btn" data-lang="en">En</button>
                <button class="lang-btn" data-lang="de">De</button>
            </div>
        </header>

        <!-- Game Panel -->
        <div id="game-panel">
            <!-- Score Board -->
            <div id="score-board">
                <div class="score-item">
                    <span id="lbl-level">å½“å‰ç­‰çº§</span>: <span id="level-val">1</span>
                </div>
                <div class="score-item">
                    <span id="lbl-streak">è¿å¯¹</span>: <span id="streak-val">0</span>
                </div>
                <div class="score-item">
                    <span id="lbl-mastery">æŒæ¡åº¦</span>:
                    <div class="progress-container">
                        <div id="mastery-bar">0%</div>
                    </div>
                </div>
            </div>

            <!-- Question Area -->
            <div id="question-area">
                <div id="question-tags">
                    <span id="tag-declension" class="tag-pill">Weak</span>
                    <span id="tag-case" class="tag-pill">Nom</span>
                </div>

                <div id="sentence-container"></div>

                <div id="context-hint">(Context Hint)</div>

                <div id="options-grid" class="hidden"></div>

                <!-- Explanation Area -->
                <div id="explanation-area" class="hidden"></div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button id="btn-mic" class="btn hidden" style="background:#d97757; width:100%; margin-bottom:10px;">ğŸ¤
                    æŒ‰ä½è¯´è¯ (Space)</button>
                <button id="btn-check" class="btn primary" disabled>æ£€æŸ¥</button>
                <button id="btn-next" class="btn primary hidden">ä¸‹ä¸€é¢˜</button>
                <button id="btn-table" class="btn" id="btn-table">æŸ¥çœ‹è¯­æ³•è¡¨</button>
            </div>

            <!-- Reward Controls -->
            <div class="reward-controls">
                <button id="btn-download-reward" class="btn" disabled>ğŸ’¾ ä¿å­˜å£çº¸</button>
                <button id="btn-next-reward" class="btn">ğŸ–¼ï¸ æ¢ä¸€å¼ </button>
            </div>
        </div>

        <!-- Settings Panel -->
        <div id="settings-panel">
            <button class="close-panel-btn">X</button>
            <h3 id="lbl-settings">éš¾åº¦è®¾ç½®</h3>

            <div class="setting-group">
                <label id="lbl-level-select">ç­‰çº§ (Level 1-5)</label>
                <div class="setting-options" style="flex-direction: row; gap: 10px;">
                    <input type="range" id="level-slider" min="1" max="5" value="1" style="width: 100%;">
                    <span id="level-display" style="font-weight:bold; min-width: 20px;">1</span>
                </div>
            </div>

            <div class="setting-group">
                <label id="lbl-mode">æ¨¡å¼</label>
                <div class="setting-options">
                    <div class="radio-wrapper">
                        <input type="radio" name="mode" id="mode-adj" value="adj" checked>
                        <label for="mode-adj" id="lbl-mode-adj">å½¢å®¹è¯è¯å°¾</label>
                    </div>
                    <div class="radio-wrapper">
                        <input type="radio" name="mode" id="mode-art" value="art">
                        <label for="mode-art" id="lbl-mode-art">åè¯å®šå† è¯</label>
                    </div>
                    <div class="radio-wrapper">
                        <input type="radio" name="mode" id="mode-k1" value="k1">
                        <label for="mode-k1" id="lbl-mode-k1">Konjunktiv I</label>
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <label id="lbl-case">æ ¼ (Case)</label>
                <div class="setting-options">
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-nom" checked> <label for="opt-nom"
                            id="lbl-nom">Nom</label></div>
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-akk" checked> <label for="opt-akk"
                            id="lbl-akk">Akk</label></div>
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-dat" checked> <label for="opt-dat"
                            id="lbl-dat">Dat</label></div>
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-gen"> <label for="opt-gen"
                            id="lbl-gen">Gen</label></div>
                </div>
            </div>

            <div class="setting-group">
                <label id="lbl-art">å† è¯ç±»å‹</label>
                <div class="setting-options">
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-def" checked> <label for="opt-def"
                            id="lbl-def">å®šå† è¯</label></div>
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-indef" checked> <label for="opt-indef"
                            id="lbl-indef">ä¸å®šå† è¯</label></div>
                    <div class="checkbox-wrapper"><input type="checkbox" id="opt-none" checked> <label for="opt-none"
                            id="lbl-none">æ— å† è¯</label></div>
                </div>
            </div>
        </div>

        <!-- Modal Table -->
        <div id="modal-table" class="modal hidden">
            <div class="modal-content">
                <span class="close-modal close-btn">&times;</span>
                <h3 id="modal-title-text">å½¢å®¹è¯è¯å°¾å˜åŒ–è¡¨</h3>

                <div class="grammar-tabs">
                    <button class="tab-btn active" data-tab="weak">å¼±å˜åŒ–</button>
                    <button class="tab-btn" data-tab="mixed">æ··åˆå˜åŒ–</button>
                    <button class="tab-btn" data-tab="strong">å¼ºå˜åŒ–</button>
                </div>

                <div id="table-container"></div>
            </div>
        </div>

        <!-- Error Log -->
        <div id="error-log"
            style="display:none; position:fixed; bottom:0; left:0; background:red; color:white; padding:10px; z-index:9999;">
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/i18n.js?v=20241130_12"></script>
    <script type="module" src="js/main.js?v=20241130_12"></script>
</body>

</html>